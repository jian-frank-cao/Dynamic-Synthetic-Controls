panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwA2.pdf",
fig.dtwA, width = 3, height = 4,
units = "in", limitsize = FALSE,
bg='transparent')
## dtwB ------------------------------------------------------------------------
fig.dtwB = df %>%
filter(unit %in% c("X pre-T", "X post-T")) %>%
ggplot(aes(x = time, y = value, color = group)) +
# geom_segment(aes(x = cutoff, y = 0, xend = cutoff, yend = 25),
#              color = "#2ab7ca", size = 1, linetype = "dashed") +
geom_rect(aes(xmin = 560, xmax = 690, ymin = 7, ymax = 19),
color = NA, fill = "grey80") +
geom_rect(aes(xmin = 305, xmax = 435, ymin = 3, ymax = 14),
color = NA, fill = "grey80") +
geom_rect(aes(xmin = 810, xmax = 920, ymin = 13, ymax = 22),
color = NA, fill = "grey90") +
geom_rect(aes(xmin = 80, xmax = 190, ymin = -1, ymax = 8),
color = NA, fill = "grey90") +
geom_line(size = 1) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#2ab7ca", size = 3) +
geom_rect(aes(xmin = 560, xmax = 690, ymin = 7, ymax = 19),
color = "grey30", fill = NA) +
geom_rect(aes(xmin = 305, xmax = 435, ymin = 3, ymax = 14),
color = "grey30", fill = NA) +
geom_curve(aes(x = 625, y = 19,
xend = 370, yend = 14),
curvature = 0.5,
linetype = "solid",
color = "grey30",
arrow = arrow(length = unit(0.03, "npc"))) +
geom_rect(aes(xmin = 810, xmax = 920, ymin = 13, ymax = 22),
color = "grey30", fill = NA, linetype = "dashed") +
geom_rect(aes(xmin = 80, xmax = 190, ymin = -1, ymax = 8),
color = "grey30", fill = NA, linetype = "dashed") +
geom_curve(aes(x = 865, y = 13,
xend = 135, yend = -1),
curvature = -0.5,
linetype = "dashed",
color = "grey30",
arrow = arrow(length = unit(0.03, "npc"))) +
scale_color_manual(name = NULL, values = c("#ee4035")) +
ylim(-10, 50) +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwB2.pdf",
fig.dtwB, width = 6, height = 4,
units = "in", limitsize = FALSE)
## dtwC ------------------------------------------------------------------------
fig.dtwC = df %>%
filter(unit %in% c("Y post-T", "X post-T", "X post-T (Warped)")) %>%
ggplot(aes(x = time, y = value, color = group)) +
# geom_line(data = df %>% filter(!is.na(dtwC)),
#           aes(group = dtwC), color = "grey80",
#           linetype = "twodash", size = 1) +
geom_line(size = 1) +
scale_color_manual(name = NULL, values = c("grey10", "#eec9d2", "#008744")) +
ylim(-10, 50) +
xlim(cutoff, 1000) +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwC2.pdf",
fig.dtwC, width = 3, height = 4,
units = "in", limitsize = FALSE)
## dtwC ------------------------------------------------------------------------
fig.dtwC = df %>%
filter(unit %in% c("Y post-T", "X post-T", "X post-T (Warped)")) %>%
ggplot(aes(x = time, y = value, color = group)) +
# geom_line(data = df %>% filter(!is.na(dtwC)),
#           aes(group = dtwC), color = "grey80",
#           linetype = "twodash", size = 1) +
geom_line(size = 1) +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#2ab7ca", size = 3) +
scale_color_manual(name = NULL, values = c("grey10", "#eec9d2", "#008744")) +
ylim(-10, 50) +
xlim(cutoff, 1000) +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwC2.pdf",
fig.dtwC, width = 3, height = 4,
units = "in", limitsize = FALSE)
## dtwC ------------------------------------------------------------------------
fig.dtwC = df %>%
filter(unit %in% c("Y post-T", "X post-T", "X post-T (Warped)")) %>%
ggplot(aes(x = time, y = value, color = group)) +
# geom_line(data = df %>% filter(!is.na(dtwC)),
#           aes(group = dtwC), color = "grey80",
#           linetype = "twodash", size = 1) +
geom_line(size = 1) +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#2ab7ca", size = 3, alpha = 0.5) +
scale_color_manual(name = NULL, values = c("grey10", "#eec9d2", "#008744")) +
ylim(-10, 50) +
xlim(cutoff, 1000) +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwC2.pdf",
fig.dtwC, width = 3, height = 4,
units = "in", limitsize = FALSE)
## dtwC ------------------------------------------------------------------------
fig.dtwC = df %>%
filter(unit %in% c("Y post-T", "X post-T", "X post-T (Warped)")) %>%
ggplot(aes(x = time, y = value, color = group)) +
# geom_line(data = df %>% filter(!is.na(dtwC)),
#           aes(group = dtwC), color = "grey80",
#           linetype = "twodash", size = 1) +
geom_line(size = 1) +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#2ab7ca", size = 3, alpha = 0.3) +
scale_color_manual(name = NULL, values = c("grey10", "#eec9d2", "#008744")) +
ylim(-10, 50) +
xlim(cutoff, 1000) +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwC2.pdf",
fig.dtwC, width = 3, height = 4,
units = "in", limitsize = FALSE)
## dtwC ------------------------------------------------------------------------
fig.dtwC = df %>%
filter(unit %in% c("Y post-T", "X post-T", "X post-T (Warped)")) %>%
ggplot(aes(x = time, y = value, color = group)) +
geom_segment(aes(x = 500, y = -10, xend = 500, yend = 50),
color = "grey10", size = 1, linetype = "solid") +
# geom_line(data = df %>% filter(!is.na(dtwC)),
#           aes(group = dtwC), color = "grey80",
#           linetype = "twodash", size = 1) +
geom_line(size = 1) +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#2ab7ca", size = 3, alpha = 0.3) +
scale_color_manual(name = NULL, values = c("grey10", "#eec9d2", "#008744")) +
ylim(-10, 50) +
xlim(cutoff, 1000) +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwC2.pdf",
fig.dtwC, width = 3, height = 4,
units = "in", limitsize = FALSE)
## Main ------------------------------------------------------------------------
fig.main = df %>%
filter(group %in% c("y", "x")) %>%
ggplot(aes(x = time, y = value, color = group)) +
geom_segment(aes(x = 500, y = -10, xend = 500, yend = 50),
color = "grey10", size = 1, linetype = "solid") +
# geom_segment(aes(x = cutoff, y = 0,
#                  xend = cutoff, yend = 30),
#              color = "#ffa700", size = 1, linetype = "dashed") +
geom_line(size = 1) +
geom_segment(aes(x = cutoff, y = df$value[cutoff+1000],
xend = t_treat, yend = df$value[t_treat]),
color = "grey40", size = 1, linetype = "dashed") +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#ee4035", size = 3) +
scale_color_manual(name = NULL, values = c("grey10", "#ee4035")) +
# annotate("text", x = 900, y = 190, size = 8,
#          label = "Y", color = "grey10") +
# annotate("text", x = 900, y = 60, size = 8,
#          label = "X", color = "#ee4035") +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_main2.pdf",
fig.main, width = 6, height = 4,
units = "in", limitsize = FALSE)
## dtwA ------------------------------------------------------------------------
fig.dtwA = df %>%
filter(unit %in% c("Y pre-T", "X pre-T")) %>%
ggplot(aes(x = time, y = value, color = unit)) +
geom_line(data = df %>% filter(!is.na(dtwA)),
aes(group = dtwA), color = "grey80",
linetype = "longdash", size = 1) +
geom_line(size = 1) +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#ee4035", size = 3) +
scale_color_manual(name = NULL, values = c("grey10", "#ee4035")) +
ylim(-10, 50) +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwA2.pdf",
fig.dtwA, width = 3, height = 4,
units = "in", limitsize = FALSE,
bg='transparent')
## dtwB ------------------------------------------------------------------------
fig.dtwB = df %>%
filter(unit %in% c("X pre-T", "X post-T")) %>%
ggplot(aes(x = time, y = value, color = group)) +
# geom_segment(aes(x = cutoff, y = 0, xend = cutoff, yend = 25),
#              color = "#2ab7ca", size = 1, linetype = "dashed") +
geom_rect(aes(xmin = 560, xmax = 690, ymin = 7, ymax = 19),
color = NA, fill = "grey80") +
geom_rect(aes(xmin = 305, xmax = 435, ymin = 3, ymax = 14),
color = NA, fill = "grey80") +
geom_rect(aes(xmin = 810, xmax = 920, ymin = 13, ymax = 22),
color = NA, fill = "grey90") +
geom_rect(aes(xmin = 80, xmax = 190, ymin = -1, ymax = 8),
color = NA, fill = "grey90") +
geom_line(size = 1) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#ee4035", size = 3) +
geom_rect(aes(xmin = 560, xmax = 690, ymin = 7, ymax = 19),
color = "grey30", fill = NA) +
geom_rect(aes(xmin = 305, xmax = 435, ymin = 3, ymax = 14),
color = "grey30", fill = NA) +
geom_curve(aes(x = 625, y = 19,
xend = 370, yend = 14),
curvature = 0.5,
linetype = "solid",
color = "grey30",
arrow = arrow(length = unit(0.03, "npc"))) +
geom_rect(aes(xmin = 810, xmax = 920, ymin = 13, ymax = 22),
color = "grey30", fill = NA, linetype = "dashed") +
geom_rect(aes(xmin = 80, xmax = 190, ymin = -1, ymax = 8),
color = "grey30", fill = NA, linetype = "dashed") +
geom_curve(aes(x = 865, y = 13,
xend = 135, yend = -1),
curvature = -0.5,
linetype = "dashed",
color = "grey30",
arrow = arrow(length = unit(0.03, "npc"))) +
scale_color_manual(name = NULL, values = c("#ee4035")) +
ylim(-10, 50) +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwB2.pdf",
fig.dtwB, width = 6, height = 4,
units = "in", limitsize = FALSE)
## dtwC ------------------------------------------------------------------------
fig.dtwC = df %>%
filter(unit %in% c("Y post-T", "X post-T", "X post-T (Warped)")) %>%
ggplot(aes(x = time, y = value, color = group)) +
geom_segment(aes(x = 500, y = -10, xend = 500, yend = 50),
color = "grey10", size = 1, linetype = "solid") +
# geom_line(data = df %>% filter(!is.na(dtwC)),
#           aes(group = dtwC), color = "grey80",
#           linetype = "twodash", size = 1) +
geom_line(size = 1) +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#eec9d2", size = 3, alpha = 0.3) +
scale_color_manual(name = NULL, values = c("grey10", "#eec9d2", "#008744")) +
ylim(-10, 50) +
xlim(cutoff, 1000) +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_dtwC2.pdf",
fig.dtwC, width = 3, height = 4,
units = "in", limitsize = FALSE)
## Main ------------------------------------------------------------------------
fig.main = df %>%
filter(group %in% c("y", "x")) %>%
ggplot(aes(x = time, y = value, color = group)) +
geom_segment(aes(x = 500, y = -10, xend = 500, yend = 50),
color = "grey10", size = 1, linetype = "solid") +
# geom_segment(aes(x = cutoff, y = 0,
#                  xend = cutoff, yend = 30),
#              color = "#ffa700", size = 1, linetype = "dashed") +
geom_line(size = 1) +
geom_segment(aes(x = cutoff, y = df$value[cutoff+1000],
xend = t_treat, yend = df$value[t_treat]),
color = "grey60", size = 1, linetype = "dashed") +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#ee4035", size = 3) +
scale_color_manual(name = NULL, values = c("grey10", "#ee4035")) +
# annotate("text", x = 900, y = 190, size = 8,
#          label = "Y", color = "grey10") +
# annotate("text", x = 900, y = 60, size = 8,
#          label = "X", color = "#ee4035") +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_main2.pdf",
fig.main, width = 6, height = 4,
units = "in", limitsize = FALSE)
## Main ------------------------------------------------------------------------
fig.main = df %>%
filter(group %in% c("y", "x")) %>%
ggplot(aes(x = time, y = value, color = group)) +
geom_segment(aes(x = 500, y = -10, xend = 500, yend = 50),
color = "grey10", size = 1, linetype = "solid") +
# geom_segment(aes(x = cutoff, y = 0,
#                  xend = cutoff, yend = 30),
#              color = "#ffa700", size = 1, linetype = "dashed") +
geom_line(size = 1) +
geom_segment(aes(x = cutoff, y = df$value[cutoff+1000],
xend = t_treat, yend = df$value[t_treat]),
color = "grey80", size = 1, linetype = "dashed") +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#ee4035", size = 3) +
scale_color_manual(name = NULL, values = c("grey10", "#ee4035")) +
# annotate("text", x = 900, y = 190, size = 8,
#          label = "Y", color = "grey10") +
# annotate("text", x = 900, y = 60, size = 8,
#          label = "X", color = "#ee4035") +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_main2.pdf",
fig.main, width = 6, height = 4,
units = "in", limitsize = FALSE)
## Main ------------------------------------------------------------------------
fig.main = df %>%
filter(group %in% c("y", "x")) %>%
ggplot(aes(x = time, y = value, color = group)) +
geom_segment(aes(x = cutoff, y = df$value[cutoff+1000],
xend = t_treat, yend = df$value[t_treat]),
color = "grey80", size = 1, linetype = "dashed") +
geom_segment(aes(x = 500, y = -10, xend = 500, yend = 50),
color = "grey10", size = 1, linetype = "solid") +
# geom_segment(aes(x = cutoff, y = 0,
#                  xend = cutoff, yend = 30),
#              color = "#ffa700", size = 1, linetype = "dashed") +
geom_line(size = 1) +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#ee4035", size = 3) +
scale_color_manual(name = NULL, values = c("grey10", "#ee4035")) +
# annotate("text", x = 900, y = 190, size = 8,
#          label = "Y", color = "grey10") +
# annotate("text", x = 900, y = 60, size = 8,
#          label = "X", color = "#ee4035") +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_main2.pdf",
fig.main, width = 6, height = 4,
units = "in", limitsize = FALSE)
## Main ------------------------------------------------------------------------
fig.main = df %>%
filter(group %in% c("y", "x")) %>%
ggplot(aes(x = time, y = value, color = group)) +
geom_segment(aes(x = cutoff, y = df$value[cutoff+1000],
xend = t_treat, yend = df$value[t_treat]),
color = "grey80", size = 1, linetype = "dashed") +
geom_segment(aes(x = 500, y = -10, xend = 500, yend = 50),
color = "grey10", size = 0.7, linetype = "solid") +
geom_line(size = 1) +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#ee4035", size = 3) +
scale_color_manual(name = NULL, values = c("grey10", "#ee4035")) +
# annotate("text", x = 900, y = 190, size = 8,
#          label = "Y", color = "grey10") +
# annotate("text", x = 900, y = 60, size = 8,
#          label = "X", color = "#ee4035") +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_main2.pdf",
fig.main, width = 6, height = 4,
units = "in", limitsize = FALSE)
## Main ------------------------------------------------------------------------
fig.main = df %>%
filter(group %in% c("y", "x")) %>%
ggplot(aes(x = time, y = value, color = group)) +
geom_segment(aes(x = cutoff, y = df$value[cutoff+1000],
xend = t_treat, yend = df$value[t_treat]),
color = "grey80", size = 1, linetype = "dashed") +
geom_segment(aes(x = 500, y = -10, xend = 500, yend = 50),
color = "grey10", size = 1, linetype = "solid") +
geom_line(size = 1) +
geom_point(aes(x = t_treat, y = df$value[t_treat]),
color = "grey10", size = 3) +
geom_point(aes(x = cutoff, y = df$value[cutoff+1000]),
color = "#ee4035", size = 3) +
scale_color_manual(name = NULL, values = c("grey10", "#ee4035")) +
# annotate("text", x = 900, y = 190, size = 8,
#          label = "Y", color = "grey10") +
# annotate("text", x = 900, y = 60, size = 8,
#          label = "X", color = "#ee4035") +
theme_minimal() +
theme(legend.position = "none",
legend.box = "horizontal",
legend.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
ggsave("./figures/method_main2.pdf",
fig.main, width = 6, height = 4,
units = "in", limitsize = FALSE)
